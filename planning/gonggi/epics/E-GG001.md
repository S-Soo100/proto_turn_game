# 공기놀이 MVP (변칙 룰 싱글 플레이 + 리더보드)

| 항목 | 값 |
|---|---|
| **ID** | E-GG001 |
| **게임** | gonggi |
| **상태** | draft |
| **우선순위** | high |
| **작성자** | claude |
| **생성일** | 2026-03-01 |
| **수정일** | 2026-03-01 |

---

## 목표

> "공기놀이 같아 보이는 열받는 게임"의 MVP를 구현한다. 변칙 룰이 항상 적용된 싱글 플레이 전용이며, 클리어 시간을 리더보드에 기록한다.

## 배경

프로젝트의 4번째 게임. 기존 게임들과 달리 물리 인터랙션 + 트롤 이벤트가 핵심. 멀티플레이 없이 싱글 플레이만 제공하며, 변칙 룰이 없는 정상 모드도 없다. 변칙 룰 자체가 게임의 본질이다.

## 범위

### 포함
- 게임 로직 (1단~5단 진행, 성공/실패 판정)
- 변칙 룰 엔진 (발동 판정, 확률 계산, 플러그인 등록)
- CR-GG001 "새가 된 공기" 연출
- CR-GG002 "고양이 습격" 연출
- 보드 컴포넌트 (2.5D + matter.js + 조작 인터랙션)
- 솔로 플레이 페이지 + 홈 카드
- 리더보드 (클리어 시간 순위표)
- Unit 테스트 + Integration 테스트
- DB: game_type + leaderboard 테이블

### 제외
- 멀티플레이 (지원 안 함)
- 정상 모드 (지원 안 함)
- AI 대전 (지원 안 함)
- 추가 변칙 룰 (후속 에픽)

## 티켓 목록

| ID | 제목 | 상태 | 담당 | 의존성 |
|---|---|---|---|---|
| T-GG001 | 공기놀이 게임 로직 구현 | draft | claude | — |
| T-GG004 | 변칙 룰 엔진 구현 | draft | claude | T-GG001 |
| T-GG002 | 보드 컴포넌트 + 2.5D + matter.js | draft | claude | T-GG001 |
| T-GG005 | CR-GG001 "새가 된 공기" 연출 | draft | claude | T-GG004, T-GG002 |
| T-GG006 | CR-GG002 "고양이 습격" 연출 | draft | claude | T-GG004, T-GG002 |
| T-GG008 | CR-GG003~008 추가 변칙 룰 연출 | draft | claude | T-GG004, T-GG002 |
| T-GG003 | 페이지 통합 + 홈 카드 | draft | claude | T-GG002 |
| T-GG007 | 리더보드 구현 | draft | claude | T-GG003 |

## 유즈케이스 목록

| ID | 제목 | 상태 |
|---|---|---|
| UC-GG001 | 솔로 공기놀이 플레이 | draft |

## 변칙 룰 문서

| ID | 이름 | 타이밍 | 상태 |
|---|---|---|---|
| CR-GG001 | 새가 된 공기 | `after-toss` | draft |
| CR-GG002 | 고양이 습격 | `before-success` | draft |
| CR-GG003 | 돌멩이의 자아 | `before-pick` | draft |
| CR-GG004 | 가짜 클리어 | `stage-transition` | draft |
| CR-GG005 | 무한 증식 | `after-toss` | draft |
| CR-GG007 | 관객 야유 | `during-play` | draft |
| CR-GG008 | 화면 뒤집기 | `stage-transition` | draft |

## 기술 고려사항

- DB 변경: `game_types`에 `gonggi` 행 + `gonggi_leaderboard` 테이블 INSERT (SQL Editor)
- **시각 표현**: 2.5D (CSS perspective + rotateX), mock-up 스타일
- **물리 엔진**: matter.js — 돌 산란, 충돌, 포물선, 바운스
- **조작 방식**: 타이밍 기반 + 스와이프-투-캐치 + 플릭-투-토스
- **변칙 룰 엔진**: 플러그인 패턴, 게임 로직과 분리
- **리더보드**: Supabase DB + RLS, 클리어 시간 ASC 정렬
- 테스트: 게임 로직 + 변칙 룰 엔진 Unit 테스트, 보드 Integration 테스트 필수

## 완료 기준

- [ ] 모든 티켓이 done 상태
- [ ] 유즈케이스 검증 완료
- [ ] 변칙 룰 2개 이상 동작
- [ ] 리더보드에 클리어 시간 기록/조회 가능
- [ ] `pnpm test:run` 전체 통과
- [ ] `pnpm build` 성공
- [ ] `.claude/rules/` 문서 최신화 완료
