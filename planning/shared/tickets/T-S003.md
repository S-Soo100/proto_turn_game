# Realtime 활성화 + 폴링 폴백 제거

| 항목 | 값 |
|---|---|
| **ID** | T-S003 |
| **에픽** | E-S002 |
| **게임** | shared |
| **상태** | draft |
| **우선순위** | high |
| **담당** | human + claude |
| **생성일** | 2026-02-27 |
| **수정일** | 2026-02-27 |
| **브랜치** | feature/T-S003-realtime-activation |
| **의존** | — |
| **차단** | — |

---

## 요약

Supabase Realtime을 정식 활성화하고, 기존 폴링 폴백 코드를 제거하여 실시간 동기화를 개선한다.

## 상세 설명

### 사용자 수동 작업 (SQL Editor + Dashboard)
1. SQL Editor에서 `ALTER TABLE games REPLICA IDENTITY FULL;` 실행
2. Supabase Dashboard → Realtime 탭 → games 테이블 활성화

### Claude 코드 작업
3. `gameStore.ts`의 `subscribeToGame`에서 폴링 폴백 (`setInterval`) 제거
4. `LobbyPage.tsx`의 2초 폴링 제거, Realtime 채널 구독으로 대체
5. 방장 대기 감지의 1.5초 폴링 제거

## 구현 가이드

### 수정할 파일
| 파일 | 변경 내용 |
|---|---|
| `src/store/gameStore.ts` | subscribeToGame에서 setInterval 폴백 제거 |
| `src/pages/LobbyPage.tsx` | 폴링 제거 + Realtime 채널 구독으로 교체 |

### DB 변경
```sql
-- Supabase SQL Editor에서 실행
ALTER TABLE games REPLICA IDENTITY FULL;
```

### 참고 패턴
- 기존 `subscribeToGame` 함수에서 Realtime 채널 구독 코드는 이미 존재 — 폴링 부분만 제거
- `LobbyPage`의 `supabase.channel('lobby')` 구독도 이미 존재 — fetchRooms 폴링만 제거

## 수락 기준

- [ ] SQL Editor에서 REPLICA IDENTITY FULL 실행 완료
- [ ] Dashboard Realtime 탭에서 games 테이블 활성화 완료
- [ ] PvP 수 놓기 → 상대 화면에 1초 이내 반영
- [ ] 로비 방 목록이 실시간 갱신
- [ ] 코드에 setInterval 폴링 폴백이 없음
- [ ] `pnpm build` 성공

## 관련 유즈케이스

| ID | 제목 |
|---|---|
| — | (에픽 레벨에서 정의) |

## 메모

- 사용자 수동 작업(SQL + Dashboard)이 선행되어야 코드 변경이 의미 있음
- Realtime 정상 작동 확인 후 코드 변경 권장
- 롤백 계획: 폴링 코드를 커밋 히스토리에서 복원 가능하도록 별도 커밋
