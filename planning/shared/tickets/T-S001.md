# ELO 레이팅 DB 스키마 + 계산 로직

| 항목 | 값 |
|---|---|
| **ID** | T-S001 |
| **에픽** | E-S001 |
| **게임** | shared |
| **상태** | draft |
| **우선순위** | medium |
| **담당** | claude |
| **생성일** | 2026-02-27 |
| **수정일** | 2026-02-27 |
| **브랜치** | feature/T-S001-elo-rating-schema |
| **의존** | — |
| **차단** | T-S002 |

---

## 요약

profiles 테이블에 ELO 레이팅 컬럼을 추가하고, 순수 함수로 ELO 계산 로직을 구현한다.

## 상세 설명

- `profiles` 테이블에 `elo_rating INTEGER DEFAULT 1200` 컬럼 추가
- `src/lib/elo.ts` 파일 생성: `calculateNewRatings(winnerRating, loserRating, isDraw)` 함수
- K-factor: 초기값 32 (추후 게임 수에 따라 조정 가능하도록 파라미터화)

## 구현 가이드

### 수정할 파일
| 파일 | 변경 내용 |
|---|---|
| `src/lib/elo.ts` | **신규** — ELO 계산 순수 함수 |
| `src/types/database.ts` | profiles 타입에 elo_rating 필드 추가 |

### DB 변경
```sql
-- Supabase SQL Editor에서 실행
ALTER TABLE profiles ADD COLUMN elo_rating INTEGER DEFAULT 1200;
```

### 참고 패턴
- ELO 공식: `Ea = 1 / (1 + 10^((Rb - Ra) / 400))`
- 새 레이팅: `Ra' = Ra + K * (Sa - Ea)` (Sa: 승=1, 패=0, 무=0.5)

## 수락 기준

- [ ] `calculateNewRatings` 함수가 승/패/무승부 모든 케이스에서 올바른 레이팅 반환
- [ ] profiles 타입에 elo_rating 필드 포함
- [ ] `pnpm build` 성공

## 관련 유즈케이스

| ID | 제목 |
|---|---|
| — | (에픽 레벨에서 정의) |

## 메모

- SQL은 사용자에게 SQL Editor 실행을 안내해야 함
- K-factor를 상수가 아닌 파라미터로 받아서 추후 조정 가능하게 설계
